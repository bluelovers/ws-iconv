"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const internal_1 = require("./lib/internal");
class WriteStream extends fs.WriteStream {
    constructor(path, options) {
        // @ts-ignore
        super(path, options);
        internal_1.getFsStreamData(this);
    }
    static get create() {
        return createWriteStream;
    }
    open() {
        if (!internal_1.getFsStreamData(this).opened) {
            const self = this;
            this[internal_1.SYM_FS_STREAM_DATA].opened = true;
            this.once('open', function () {
                process.nextTick(function () {
                    self.emit('ready');
                });
            });
            // @ts-ignore
            fs.WriteStream.prototype.open.call(this);
        }
    }
}
exports.WriteStream = WriteStream;
function createWriteStream(path, options) {
    return new WriteStream(path, options);
}
exports.createWriteStream = createWriteStream;
exports.default = WriteStream;
// @ts-ignore
Object.freeze(exports);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid3JpdGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ3cml0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlCQUEwQjtBQUcxQiw2Q0FBcUU7QUFFckUsTUFBYSxXQUFZLFNBQVEsRUFBRSxDQUFDLFdBQVc7SUF5QjlDLFlBQVksSUFBYyxFQUFFLE9BQXdDO1FBRW5FLGFBQWE7UUFDYixLQUFLLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFBO1FBRXBCLDBCQUFlLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDdEIsQ0FBQztJQUVELE1BQU0sS0FBSyxNQUFNO1FBRWhCLE9BQU8saUJBQWlCLENBQUE7SUFDekIsQ0FBQztJQUVELElBQUk7UUFFSCxJQUFJLENBQUMsMEJBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLEVBQ2pDO1lBQ0MsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFBO1lBRWpCLElBQUksQ0FBQyw2QkFBa0IsQ0FBQyxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUE7WUFFdEMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7Z0JBRWpCLE9BQU8sQ0FBQyxRQUFRLENBQUM7b0JBRWhCLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7Z0JBQ25CLENBQUMsQ0FBQyxDQUFBO1lBQ0gsQ0FBQyxDQUFDLENBQUE7WUFDRixhQUFhO1lBQ2IsRUFBRSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQTtTQUN4QztJQUNGLENBQUM7Q0FFRDtBQTFERCxrQ0EwREM7QUFFRCxTQUFnQixpQkFBaUIsQ0FBQyxJQUFjLEVBQUUsT0FBd0M7SUFFekYsT0FBTyxJQUFJLFdBQVcsQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUE7QUFDdEMsQ0FBQztBQUhELDhDQUdDO0FBRUQsa0JBQWUsV0FBVyxDQUFBO0FBQzFCLGFBQWE7QUFDYixNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzID0gcmVxdWlyZShcImZzXCIpO1xuaW1wb3J0IHsgUGF0aExpa2UgfSBmcm9tICdmcyc7XG5pbXBvcnQgeyBJRnNQYXRoLCBJRnNTdHJlYW1EYXRhLCBJRnNTdHJlYW1TdGF0ZSwgSUZzV3JpdGVTdHJlYW1PcHRpb25zIH0gZnJvbSAnLi9saWIvaW50ZXJmYWNlJztcbmltcG9ydCB7IGdldEZzU3RyZWFtRGF0YSwgU1lNX0ZTX1NUUkVBTV9EQVRBIH0gZnJvbSAnLi9saWIvaW50ZXJuYWwnO1xuXG5leHBvcnQgY2xhc3MgV3JpdGVTdHJlYW0gZXh0ZW5kcyBmcy5Xcml0ZVN0cmVhbVxue1xuXHRwcm90ZWN0ZWQgYXV0b0Nsb3NlOiBib29sZWFuXG5cdHByb3RlY3RlZCBmbGFnczogc3RyaW5nXG5cdGZkOiBudW1iZXJcblx0cHJvdGVjdGVkIG1vZGU6IG51bWJlclxuXHRwcm90ZWN0ZWQgcG9zOiBudW1iZXJcblx0cHJvdGVjdGVkIGNsb3NlZDogYm9vbGVhblxuXHRwcm90ZWN0ZWQgZGVzdHJveWVkOiBib29sZWFuXG5cblx0cHJvdGVjdGVkIF93cml0YWJsZVN0YXRlOiBJRnNTdHJlYW1TdGF0ZVxuXHRwcm90ZWN0ZWQgX3JlYWRhYmxlU3RhdGU6IElGc1N0cmVhbVN0YXRlXG5cblx0cHJvdGVjdGVkIFtTWU1fRlNfU1RSRUFNX0RBVEFdOiBJRnNTdHJlYW1EYXRhXG5cblx0LyoqXG5cdCAqIFRoZSBudW1iZXIgb2YgYnl0ZXMgd3JpdHRlbiBzbyBmYXIuIERvZXMgbm90IGluY2x1ZGUgZGF0YSB0aGF0IGlzIHN0aWxsIHF1ZXVlZCBmb3Igd3JpdGluZy5cblx0ICovXG5cdHB1YmxpYyBieXRlc1dyaXR0ZW46IG51bWJlclxuXG5cdC8qKlxuXHQgKiBUaGUgcGF0aCB0byB0aGUgZmlsZSB0aGUgc3RyZWFtIGlzIHdyaXRpbmcgdG8gYXMgc3BlY2lmaWVkIGluIHRoZSBmaXJzdCBhcmd1bWVudCB0byBmcy5jcmVhdGVXcml0ZVN0cmVhbSgpLiBJZiBwYXRoIGlzIHBhc3NlZCBhcyBhIHN0cmluZywgdGhlbiB3cml0ZVN0cmVhbS5wYXRoIHdpbGwgYmUgYSBzdHJpbmcuIElmIHBhdGggaXMgcGFzc2VkIGFzIGEgQnVmZmVyLCB0aGVuIHdyaXRlU3RyZWFtLnBhdGggd2lsbCBiZSBhIEJ1ZmZlci5cblx0ICovXG5cdHB1YmxpYyByZWFkb25seSBwYXRoOiBJRnNQYXRoXG5cblx0Y29uc3RydWN0b3IocGF0aDogUGF0aExpa2UsIG9wdGlvbnM/OiBzdHJpbmcgfCBJRnNXcml0ZVN0cmVhbU9wdGlvbnMpXG5cdHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0c3VwZXIocGF0aCwgb3B0aW9ucylcblxuXHRcdGdldEZzU3RyZWFtRGF0YSh0aGlzKVxuXHR9XG5cblx0c3RhdGljIGdldCBjcmVhdGUoKVxuXHR7XG5cdFx0cmV0dXJuIGNyZWF0ZVdyaXRlU3RyZWFtXG5cdH1cblxuXHRvcGVuKClcblx0e1xuXHRcdGlmICghZ2V0RnNTdHJlYW1EYXRhKHRoaXMpLm9wZW5lZClcblx0XHR7XG5cdFx0XHRjb25zdCBzZWxmID0gdGhpc1xuXG5cdFx0XHR0aGlzW1NZTV9GU19TVFJFQU1fREFUQV0ub3BlbmVkID0gdHJ1ZVxuXG5cdFx0XHR0aGlzLm9uY2UoJ29wZW4nLCBmdW5jdGlvbiAoKVxuXHRcdFx0e1xuXHRcdFx0XHRwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRzZWxmLmVtaXQoJ3JlYWR5Jylcblx0XHRcdFx0fSlcblx0XHRcdH0pXG5cdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRmcy5Xcml0ZVN0cmVhbS5wcm90b3R5cGUub3Blbi5jYWxsKHRoaXMpXG5cdFx0fVxuXHR9XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVdyaXRlU3RyZWFtKHBhdGg6IFBhdGhMaWtlLCBvcHRpb25zPzogc3RyaW5nIHwgSUZzV3JpdGVTdHJlYW1PcHRpb25zKVxue1xuXHRyZXR1cm4gbmV3IFdyaXRlU3RyZWFtKHBhdGgsIG9wdGlvbnMpXG59XG5cbmV4cG9ydCBkZWZhdWx0IFdyaXRlU3RyZWFtXG4vLyBAdHMtaWdub3JlXG5PYmplY3QuZnJlZXplKGV4cG9ydHMpXG4iXX0=